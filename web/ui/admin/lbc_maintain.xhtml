<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:util="http://java.sun.com/jsf/composite/composite/util"
                template="/WEB-INF/template/admin/admin_layout.xhtml">
    <ui:define name="metadata">
        <f:metadata>
            <f:viewAction action="#{locationMaintainView.loadData}" onPostback="false"/>
        </f:metadata>
    </ui:define>
    <ui:define name="CenterContent">
        <p:tabView id="lbcMaintainTabView">
            <p:tab title="城市" id="cityMaintain">
                <h:form prependId="false" id="cityForm">
                    <h:panelGrid id="searchCity" columns="2">
                        <h:outputLabel for="provinceOneMenu" value="省份:"/>
                        <p:selectOneMenu id="provinceOneMenu"
                                         value="#{locationMaintainView.lbcSearchCriteria.provinceCode}"
                                         style="width: 120px;">
                            <f:selectItems value="#{locationMaintainView.provinceList}" var="province"
                                           itemLabel="#{province.provinceName}" itemValue="#{province.provinceCode}"/>
                            <p:ajax update="cityList" listener="#{locationMaintainView.loadCityListFromProvinceCode}"
                                    process="searchCity"/>
                        </p:selectOneMenu>
                    </h:panelGrid>
                    <br/>

                    <p:dataTable id="cityList" value="#{locationMaintainView.cityList}" var="city"
                                 paginator="true" rows="10"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
                                 editable="true">
                        <p:columnGroup type="header">
                            <p:row>
                                <p:column headerText="省份-#{fn:length(locationMaintainView.cityList)}"
                                          styleClass="table_header"/>
                                <p:column headerText="城市" styleClass="table_header"/>
                                <p:column headerText="城市代码" styleClass="table_header"/>
                            </p:row>
                        </p:columnGroup>
                        <p:column rowspan="5" styleClass="table_header">
                            <h:outputText value="#{city.province.provinceName}"/>
                        </p:column>

                        <p:column styleClass="table_header">
                            <h:outputText value="#{city.cityName}"/>
                        </p:column>

                        <p:column styleClass="table_header">
                            <h:outputText value="#{city.cityCode}"/>
                        </p:column>
                    </p:dataTable>
                    <br/>
                    <ui:include src="segments/new_city.xhtml"></ui:include>
                </h:form>

            </p:tab>

            <p:tab title="新建区(县)" id="districtMaintain">
                <h:form prependId="false" id="districtForm">
                    <!--                    <city:citySelector provinceList="#{supportDataMaintainView.provinceList}" actionBean="#{supportDataMaintainView}"
                                                           provinceCode="#{supportDataMaintainView.lbcSearchCriteria.provinceCode}" cityCode="#{supportDataMaintainView.lbcSearchCriteria.cityCode}"
                                                           targetID="distinctList" changeProvinceAction="#{supportDataMaintainView.loadCityListFromProvinceCode}" cityList="#{supportDataMaintainView.cityList}"
                                                  changeCityAction="#{supportDataMaintainView.loadDistrictListFromCityCode}"/>-->
                    <h:panelGrid id="searchDistrict" columns="4">
                        <ui:include src="segments/city_selector.xhtml">
                            <ui:param name="componentID" value="listCityTable"></ui:param>
                            <ui:param name="view" value="#{locationMaintainView}"></ui:param>
                            <ui:param name="refreshTable" value="true"></ui:param>
                        </ui:include>
                        <!--<h:outputLabel for="provinceMenuList" value="省份:"/>
                        <p:selectOneMenu id="provinceMenuList"
                                         value="#{supportDataMaintainView.lbcSearchCriteria.provinceCode}"
                                         style="width: 120px;">
                            <f:selectItems value="#{supportDataMaintainView.provinceList}" var="province"
                                           itemLabel="#{province.provinceName}" itemValue="#{province.provinceCode}"/>
                            <p:ajax update="cityMenuList" listener="#{supportDataMaintainView.loadCityListFromProvinceCode}"/>
                        </p:selectOneMenu>

                        <h:outputLabel for="cityMenuList" value="城市:"/>
                        <p:selectOneMenu id="cityMenuList" value="#{supportDataMaintainView.lbcSearchCriteria.cityCode}">
                            <f:selectItem itemLabel="选择城市" itemValue="" />
                            <f:selectItems value="#{supportDataMaintainView.cityList}" var="city"
                                           itemLabel="#{city.cityName}" itemValue="#{city.cityCode}"/>
                            <p:ajax update="distinctList" listener="#{supportDataMaintainView.loadDistrictListFromCityCode}"/>
                        </p:selectOneMenu>-->
                    </h:panelGrid>
                    <br/>

                    <p:dataTable id="distinctList" value="#{locationMaintainView.districtList}" var="district"
                                 paginator="true" rows="10"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
                                 editable="true">
                        <p:columnGroup type="header">
                            <p:row>
                                <p:column headerText="城市" styleClass="table_header"/>
                                <p:column headerText="区" styleClass="table_header"/>
                                <p:column headerText="区代码" styleClass="table_header"/>
                            </p:row>
                        </p:columnGroup>
                        <p:column styleClass="table_header">
                            <h:outputText value="#{district.city.cityName}"/>
                        </p:column>

                        <p:column styleClass="table_header">
                            <h:outputText value="#{district.districtName}"/>
                        </p:column>

                        <p:column styleClass="table_header">
                            <h:outputText value="#{district.districtCode}"/>
                        </p:column>
                    </p:dataTable>
                    <br/>
                    <ui:include src="segments/new_district.xhtml"></ui:include>
                </h:form>
            </p:tab>

            <p:tab title="生活商业圈" id="lbcMaintain">
                <h:form prependId="false" id="lbcForm">
                    <h:panelGrid id="searchLBC" columns="6">
                        <h:outputLabel for="lbcProvinceMenuList" value="省份:"/>
                        <p:selectOneMenu id="lbcProvinceMenuList"
                                         value="#{locationMaintainView.lbcSearchCriteria.provinceCode}"
                                         style="width: 120px;">
                            <f:selectItems value="#{locationMaintainView.provinceList}" var="province"
                                           itemLabel="#{province.provinceName}" itemValue="#{province.provinceCode}"/>
                            <p:ajax update="lbcCityMenuList lbcDistinctList lbcDistinctTable" listener="#{locationMaintainView.loadCityListFromProvinceCode}"/>
                        </p:selectOneMenu>

                        <h:outputLabel for="lbcCityMenuList" value="城市:"/>
                        <p:selectOneMenu id="lbcCityMenuList" value="#{locationMaintainView.lbcSearchCriteria.cityCode}">
                            <f:selectItem itemLabel="选择城市" itemValue="" />
                            <f:selectItems value="#{locationMaintainView.cityList}" var="city"
                                           itemLabel="#{city.cityName}" itemValue="#{city.cityCode}"/>
                            <p:ajax update="lbcDistinctList lbcDistinctTable" listener="#{locationMaintainView.loadDistrictListFromCityCode}"/>
                        </p:selectOneMenu>

                        <h:outputLabel for="lbcDistinctList" value="区:"/>
                        <p:selectOneMenu id="lbcDistinctList" value="#{locationMaintainView.lbcSearchCriteria.districtCode}">
                            <f:selectItem itemLabel="选择城市" itemValue="" />
                            <f:selectItems value="#{locationMaintainView.districtList}" var="district"
                                           itemLabel="#{district.districtName}" itemValue="#{district.districtCode}"/>
                            <p:ajax update="lbcDistinctTable" listener="#{locationMaintainView.loadLBCFromDistrictCode}"/>
                        </p:selectOneMenu>
                    </h:panelGrid>
                    <br/>

                    <p:dataTable id="lbcDistinctTable" value="#{locationMaintainView.lifeBusinessCircleList}" var="lbc"
                                 paginator="true" rows="10"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
                                 editable="true">
                        <p:columnGroup type="header">
                            <p:row>
                                <p:column headerText="区" styleClass="table_header"/>
                                <p:column headerText="圈名称" styleClass="table_header"/>
                                <p:column headerText="圈代码" styleClass="table_header"/>
                            </p:row>
                        </p:columnGroup>
                        <p:column styleClass="table_header">
                            <h:outputText value="#{lbc.district.districtName}"/>
                        </p:column>

                        <p:column styleClass="table_header">
                            <h:outputText value="#{lbc.circleName}"/>
                        </p:column>

                        <p:column styleClass="table_header">
                            <h:outputText value="#{lbc.circleCode}"/>
                        </p:column>
                    </p:dataTable>
                    <br/>
                    <ui:include src="segments/new_lbc.xhtml"></ui:include>
                </h:form>
            </p:tab>
        </p:tabView>

        <div style="color: red;">
            <util:debug/>
        </div>
    </ui:define>
</ui:composition>